<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PPOAlgo Prop Desk</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="title">PPOAlgo â€“ Prop Firm Console</div>
      <div class="subtitle">Interactive, simulated GUI</div>
    </div>
    <div class="actions">
      <button class="ghost" id="btn-load-data">Load historical data</button>
      <button class="ghost" id="btn-focus-model">Select model</button>
      <button class="primary" id="btn-run-backtest">Run backtest</button>
      <a href="paper.html" class="paper-trade" id="btn-go-paper"
        style="text-decoration: none; display: inline-flex; align-items: center;">ðŸš€ Go Paper</a>
      <button class="ghost" id="btn-toggle-logs">Show logs</button>
      <button class="secondary" id="btn-export">Export results</button>
    </div>
  </header>

  <main class="main-grid">
    <aside class="panel narrow">
      <div class="panel-header">
        <h2>Model & Config</h2>
        <p class="hint">Choose model, toggles, and checkpoints.</p>
      </div>
      <div class="form-grid">
        <label>
          Model
          <select id="model-select">
            <option value="ppo">PPO</option>
            <option value="lstm">LSTM</option>
            <option value="baseline">Baseline</option>
            <option value="momentum">Momentum</option>
          </select>
        </label>
        <div class="desc-controls">
          <button class="secondary" id="toggle-desc">Hide description</button>
        </div>
        <div id="algo-desc" class="desc-box"></div>
        <label>
          PPO policy
          <select id="ppo-policy">
            <option value="mlp">MLP</option>
            <option value="cnn">CNN</option>
            <option value="transformer">Transformer</option>
          </select>
        </label>
        <label>
          PPO checkpoint
          <input id="ppo-checkpoint" type="text" placeholder="checkpoint path or tag" />
        </label>
        <label class="toggle-row">
          <input type="checkbox" id="toggle-lstm" checked />
          <span>LSTM predictor</span>
        </label>
        <label class="toggle-row">
          <input type="checkbox" id="toggle-sentiment" />
          <span>Sentiment</span>
        </label>
      </div>

      <div id="training-generic">
        <div class="panel-subheader">Training settings</div>
        <div class="slider">
          <div class="slider-row">
            <label for="steps-range">Number of steps</label>
            <span id="steps-value">200k</span>
          </div>
          <input id="steps-range" type="range" min="10000" max="1000000" step="10000" value="200000" />
        </div>
        <div class="slider">
          <div class="slider-row">
            <label for="gamma-range">Gamma</label>
            <span id="gamma-value">0.99</span>
          </div>
          <input id="gamma-range" type="range" min="0.8" max="0.999" step="0.001" value="0.99" />
        </div>
        <div class="slider">
          <div class="slider-row">
            <label for="clip-range">Clip range</label>
            <span id="clip-value">0.20</span>
          </div>
          <input id="clip-range" type="range" min="0.05" max="0.4" step="0.01" value="0.2" />
        </div>
        <div class="slider">
          <div class="slider-row">
            <label for="lr-range">Learning rate</label>
            <span id="lr-value">0.0003</span>
          </div>
          <input id="lr-range" type="range" min="0.00005" max="0.005" step="0.00005" value="0.0003" />
        </div>
      </div>

      <div id="training-momentum" class="hidden">
        <div class="panel-subheader">Momentum settings</div>
        <div class="form-grid">
          <label>
            Buy trigger %
            <input id="mom-buy-trigger" type="number" step="0.1" min="0" value="5" />
          </label>
          <label>
            Buy time (CDT)
            <input id="mom-buy-time" type="time" value="09:00" />
          </label>
          <label>
            Sell trigger %
            <input id="mom-sell-trigger" type="number" step="0.1" min="0" value="9" />
          </label>
          <label>
            Buy amount ($)
            <input id="mom-buy-amount" type="number" step="100" min="0" value="1000" />
          </label>
          <label class="toggle-row">
            <input type="checkbox" id="mom-compound" />
            <span>Compound (reinvest proceeds)</span>
          </label>
        </div>
      </div>

      <div class="panel-subheader">Backtest settings</div>
      <div class="form-grid">
        <label>
          Stock ticker
          <input id="stock-symbol" type="text" value="AAPL" />
        </label>
        <label>
          Start date
          <input id="start-date" type="date" value="2020-01-01" />
        </label>
        <label>
          End date
          <input id="end-date" type="date" value="2020-12-31" />
        </label>
        <label>
          Initial capital
          <input id="capital" type="number" value="100000" />
        </label>
        <label>
          Trading fees (bps)
          <input id="fees" type="number" step="0.01" value="5" />
        </label>
        <label>
          Slippage %
          <input id="slippage" type="number" step="0.01" value="0.05" />
        </label>
      </div>
      <button class="secondary" id="btn-apply-settings">Apply settings</button>
      <span id="config-status" class="status-pill muted">Not saved</span>
    </aside>

    <section class="panel center">
      <div class="panel-header">
        <h2>Charts</h2>
        <p class="hint">Price, PPO decisions, position sizing, and portfolio curve.</p>
      </div>
      <div class="chart-card">
        <div class="chart-title">
          <span>Price chart + PPO decisions</span>
          <div class="legend">
            <span class="dot buy"></span> Buy
            <span class="dot sell"></span> Sell
            <span class="dot reduce"></span> Reduce
            <span class="dot flat"></span> Flat
          </div>
        </div>
        <div class="chart" id="price-chart"></div>
        <div class="chart-dates">
          <span id="chart-start"></span>
          <span id="chart-price-start" class="chart-price"></span>
          <span id="chart-price-end" class="chart-price"></span>
          <span id="chart-end"></span>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-title">
          <span>Position size (long/short %)</span>
        </div>
        <div class="chart" id="position-chart"></div>
      </div>

      <div class="chart-grid">
        <div class="chart-card">
          <div class="chart-title">
            <span>Portfolio value</span>
          </div>
          <div class="chart" id="portfolio-chart"></div>
        </div>
        <div class="chart-card">
          <div class="chart-title">
            <span>Drawdown & returns</span>
          </div>
          <div class="chart" id="dd-chart"></div>
        </div>
      </div>
    </section>

    <aside class="panel narrow">
      <div class="panel-header">
        <h2>Stats & Metrics</h2>
        <p class="hint">Performance and stability signals.</p>
      </div>
      <div class="metric-section">
        <button class="btn-trade-it" id="btn-trade-it" onclick="addToPaperTrading()">
          ðŸš€ Trade It
        </button>
        <div class="metric-title">Performance</div>
        <div class="metric-grid">
          <div class="metric"><span>Total return</span><strong id="m-return">--</strong></div>
          <div class="metric"><span>Sharpe</span><strong id="m-sharpe">--</strong></div>
          <div class="metric"><span>Sortino</span><strong id="m-sortino">--</strong></div>
          <div class="metric"><span>Max DD</span><strong id="m-dd">--</strong></div>
          <div class="metric"><span>Win rate</span><strong id="m-winrate">--</strong></div>
          <div class="metric"><span>Avg win/loss</span><strong id="m-avg">--</strong></div>
          <div class="metric"><span>Commission</span><strong id="m-comm">--</strong></div>
          <div class="metric"><span>Slippage</span><strong id="m-slip">--</strong></div>
        </div>
      </div>
      <div class="metric-section">
        <div class="metric-title">Stability</div>
        <div class="metric-grid">
          <div class="metric"><span>Action entropy</span><strong id="m-entropy">--</strong></div>
          <div class="metric"><span>Value loss</span><strong id="m-vloss">--</strong></div>
          <div class="metric"><span>Policy loss</span><strong id="m-ploss">--</strong></div>
          <div class="metric"><span>Clip fraction</span><strong id="m-clip">--</strong></div>
          <div class="metric status"><span>Status</span><strong id="m-status">--</strong></div>
        </div>
      </div>
    </aside>
  </main>

  <section class="panel full" id="logs-panel">
    <div class="panel-header">
      <h2>Trade log</h2>
      <p class="hint">Chronological trades; export for review.</p>
    </div>
    <div class="log-controls">
      <button class="secondary" id="btn-clear-trades">Clear table</button>
      <button class="secondary" id="btn-clear-logs">Clear activity log</button>
      <label class="toggle">
        <input type="checkbox" id="auto-scroll" checked />
        <span>Auto-scroll</span>
      </label>
    </div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Timestamp</th>
            <th>Price</th>
            <th>% from prev close</th>
            <th>Purchased/Sold ($)</th>
            <th>Action</th>
            <th>Position size</th>
            <th>Trade P/L %</th>
            <th>Unrealized PnL</th>
            <th>Realized PnL</th>
            <th>Wallet ($)</th>
          </tr>
        </thead>
        <tbody id="trade-body"></tbody>
      </table>
    </div>
    <div class="panel-subheader">Activity log</div>
    <div id="log" class="log"></div>
  </section>

  <footer class="footer">
    All interactions are simulated in-browser. Wire up real APIs to connect the PPO/LSTM entrypoints.
  </footer>

  <!-- Paper Trading is now on a separate page: paper.html -->

  <script src="app.js"></script>
</body>

</html>